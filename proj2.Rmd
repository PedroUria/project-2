---
title: "Project-2-Markdown"
author: "Sean Pili"
date: "December 1, 2018"
output: html_document
---

```{r install_functions, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
##Helper Functions here for cleanly handling imports
#install_all - function for installing all packages in a list that aren't available
#  inspired by https://stackoverflow.com/questions/4090169/elegant-way-to-check-for-missing-packages-and-install-them
#  ex: install_all(c('readr', 'dplyr'))
install_all <- function(list.of.packages) {
  need_install <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
  if(length(need_install)) install.packages(need_install)
}

# package_apply_all - function for calling install_all on list of packages, then applying a function to them
#  inspired by https://stackoverflow.com/questions/8175912/load-multiple-packages-at-once
#  ex: package_apply_all(c('readr', 'dplyr'), require)
package_apply_all <- function(list.of.packages, func) {
  install_all(list.of.packages)
  invisible(lapply(list.of.packages, func, character.only = TRUE))
}
```

```{r imports, include=FALSE}
package_apply_all(
  c(
    'readr', # for loading data from various formats
    'dplyr', # because we all need a little magic
    'ggplot2', # pretty graphs
    'tidyr' # needed for the gather function
  ), require)
```

```{r helpers, include=FALSE}
# Pull in Consumer Price Index Data from 
# Burea of Labor Statistics to account for inflation
cpi <- read_csv('CPI_20181201.csv', col_types = cols())
# data ranged from 2000 (1) to 2017 (18)
# so... year mod 2000 + 1 is the indexing scheme.
# NOTE: if cpi csv file is changed the indexing scheme will need updating
cpif <- function(year) {
  idx <- year %% 2000 + 1
  cpi$Annual[idx]
}

```

# Stating the Question

Can we predict how likely a movie is to win an Oscar given information about that movie being nominated to, or winning other awards prior to the Oscars?

TODO: Expand discussion of background some/etc...

# Exploratory Data Analysis

```{r initialize}
# oscars data
pat.oscar_won <- "Oscar_.*_won$"
pat.oscar_nom <- "Oscar_.*_nominated$"
oscars <- read_csv("oscars.csv", col_types = cols()) %>% mutate(
  # Adjust gross field by Consumer Price Index.
  # cpif provides annual average CPI for specified year
  # data provided by the Burea of Labor Statistics website
  # (implementation included in full Rmd document)
  sc.gross = gross * cpif(2000)/cpif(year) # "In 2000 dollars"
) %>% 
  # mutate oscars won and oscars nominated cols/variables to factor types
  mutate_at(vars(matches(pat.oscar_won)), funs(factor)) %>%
  mutate_at(vars(matches(pat.oscar_nom)), funs(factor))
```

# Model Building

Discussion of choice of model.. both logistic, and penalized for comparison to ensure best possible model... etc...

## Logistic Regression

### Model Validation/Testing

## Penalized Logistic Regression

### Model Validation/Testing

# Interpret (In detail what do the models tell us)

What does the model tell us?

# Communicate (Conclusion?)

Were we able to answer the question?



```{r currency_validation}
# Validation of currency adjustment
currency_info <- oscars %>% select(
  gross, sc.gross, year
) %>% mutate(
  diff = gross - sc.gross
) %>% group_by(year) %>% summarize(
  n=n(),
  diff_mn = mean(diff, na.rm = TRUE),
  gross_mn = mean(gross, na.rm = TRUE),
  sc.gross_mn = mean(sc.gross, na.rm = TRUE)
)

currency_info %>% 
  gather(key, value, gross_mn, sc.gross_mn) %>%
  ggplot(aes(x=year, y=value, colour=key)) + 
  geom_line()
```

The CPI based adjustment seems to have behaved as expected.

##

## Pedro's issues

### Target: Won At Least One Oscar

```{r oscars_won_some}
# sum number of wins identified per row for cols
tmp.won <- rowSums(
  oscars %>%
    mutate_at(
      vars(matches(pat.oscar_won)),
      funs(ifelse(. == "No", 0, 1))
    ) %>% select(matches(pat.oscar_won))
  )

# set win count variable in oscars df
oscars <- oscars %>% 
  mutate(Oscars_win_count = tmp.won)

# Validation
oscars_won_best_picture <- filter(oscars, Oscar_Best_Picture_won == 'Yes')
# This movie won 3 oscars, let's see if it checks out
oscars_won_best_picture$Oscars_win_count[1] == 3
# This movie won 2 oscars, let's see if it checks out
oscars_won_best_picture$Oscars_win_count[2] == 2
# Yeap

# Encodes as factor
oscars <- oscars %>% mutate(
  Oscars_won_some = factor(ifelse(Oscars_win_count > 0, "Yes", "No"))
)
```

### Awards_wins

`awards_wins`... does it count the Oscars too?
```{r}
# Gets the movies that won Oscars for best picture 
oscars_won_best_picture <- subset(oscars, Oscar_Best_Picture_won == "Yes")
dim(oscars_won_best_picture)
# Gets the first movie of such list
lord_of_the_rings_king <- head(oscars_won_best_picture, 1)
# Gets the number of awards it won, not counting the Oscars 
num_awards_won <- 0
# For every column name in the Series
for (i in names(lord_of_the_rings_king)){
  # If "won"" is in the column name at the end
  if(grepl("won$", i) == TRUE){
    # And if "Oscar" is not in the column name
     if(grepl("Oscar", i) == FALSE){
         # Add to num_awards_won the value of such column
         num_awards_won = num_awards_won + lord_of_the_rings_king[c(i)][[1]]
      }
  }
}
# Prints the value of awards_wins
lord_of_the_rings_king[c("awards_wins")]
# Prints the number of awards it won, not counting the Oscars
num_awards_won
```
It does NOT!! Which is good for us. 


### Certificate

Encode `certificate`, which follows this [system](https://www.wikiwand.com/en/Motion_Picture_Association_of_America_film_rating_system) and this [one](https://www.wikiwand.com/en/TV_parental_guidelines_(US)#/TV-MA). 

```{r}
# Prints the unique values of the certificate column
unique(oscars$certificate)
# Prints the movies "Unrated" and "Not Rated"
subset(oscars, certificate == "Not Rated")[c("movie")]
subset(oscars, certificate == "Unrated")[c("movie")]
```

Let's get rid of these rows. They would only make us create more columns for `certificate`, as we can't encode them, and they are not well known movies (aside from The Great Beauty...) and didn't win any oscars. It's either this or treat `certificate` as a factor (which will be converted by R into dummies, i.e, more columns).

```{r}
# Gets the indexes of such rows
not_rated_index = as.numeric(rownames(subset(oscars, certificate == "Not Rated")[c("movie")]))
unrated_index =  as.numeric(rownames(subset(oscars, certificate == "Unrated")[c("movie")]))

# Checks if any of them won an oscar
for(i in 1:nrow(oscars[not_rated_index, ])){
  if(oscars[not_rated_index, ]$Oscars_won_some[i] == "Yes"){
    print("Yes")
  }
}
for(i in 1:nrow(oscars[unrated_index, ])){
  if(oscars[unrated_index, ]$Oscars_won_some[i] == "Yes"){
    print("Yes")
  }
}
```

Alright, let's drop'em.

```{r}
dim(oscars)
# https://github.com/tidyverse/dplyr/issues/3196
oscars = oscars %>% filter(certificate != "Not Rated" | is.na(certificate)) %>% filter(certificate != "Unrated" | is.na(certificate))
dim(oscars)
```

And now encode the column

```{r}
unique(oscars$certificate)
sum(is.na(oscars$certificate))
```

let's actually see if we can get the missing values imputed first.

```{r}
titles_missing_values = oscars[is.na(oscars$certificate), ]$movie
titles_missing_values
```

If we look up these titles in IMDB, they are not rated. Let's check once again if they won any oscars.

```{r}
for(i in titles_missing_values){
  if(subset(oscars, movie == i)$Oscars_won_some == "Yes"){
    print("Yes")}
}
```

Nop, let's drop them too.

```{r}
oscars = oscars %>% filter(is.na(certificate) == FALSE)
dim(oscars)
```

And finally let's encode it...

```{r}
unique(oscars$certificate)
oscars = oscars %>% mutate(certificate = replace(certificate, certificate == "PG-13", 3))
oscars = oscars %>% mutate(certificate = replace(certificate, certificate == "G", 1))
oscars = oscars %>% mutate(certificate = replace(certificate, certificate == "R", 4))
oscars = oscars %>% mutate(certificate = replace(certificate, certificate == "PG", 2))
oscars = oscars %>% mutate(certificate = replace(certificate, certificate == "TV-MA", 5))
oscars$certificate = as.numeric(oscars$certificate)
unique(oscars$certificate)
```

### cleanup genre
```{r}
# cl
# get rid of NA's
#oscars[which(is.na(oscars$genre)==TRUE),]$genre = "none"

# get all of the values parsed by |'s
genre_unique = unique(oscars$genre)
# get the actual unique values
soup = c()
for(i in 1:length(genre_unique)){
  soup = append(soup,unlist(strsplit(genre_unique[i],"\\|")))
}
new_cols = unique(soup)

# create a dataframe where the column names are the unique genres
gen = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(gen) = new_cols

for(i in 1:ncol(gen)){
  # iterate over columns
  for(j in 1:nrow(gen)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(gen[i]),oscars$genre[j])==TRUE)){ 
      gen[j,i] = 1
      }
    else{
      gen[j,i] = 0
    }
  }
}

# we add the prefix "genre", so that the varaibles are easier to identify. 
colnames(gen) = paste("genre",colnames(gen),sep="_")

# get rid of the mispelling of history... somehow some moves were classified as histor and history
# assume music and musical are the same genre. 
gen$genre_History = gen$genre_History + gen$genre_Histor
gen$genre_Musical = gen$genre_Musical + gen$genre_Music


# check for duplicates
max(gen$genre_History)
max(gen$genre_Musical)
# we have them in both, so remove them. 

for(i in 1:length(gen$genre_History)){
  if(gen$genre_History[i]>1){
    gen$genre_History[i] =1
  }
}

for(i in 1:length(gen$genre_Musical)){
  if(gen$genre_Musical[i]>1){
    gen$genre_Musical[i] =1
  }
}

# select the columns that are duplicated
DropCols = c("genre_Histor","genre_Music")
# remove them from the datframe. 

gen = gen[,!colnames(gen)%in%DropCols]

oscars = cbind(oscars,gen)

# Changing 0 to "No" and 1 to "Yes"
for(i in names(gen)){
  oscars[c(i)][[1]] = ifelse(oscars[c(i)][[1]] == 1, "Yes", "No")
  oscars[c(i)][[1]] = factor(oscars[c(i)][[1]])
}
```

### Some more preprocessing:

TODO: Undrop `release_date.month` when it is dealt with.
```{r}
# Drops columns we do not want to predict Oscars_won_some
drop.cols <- c(
  'movie',
  'movie_id',
  'synopsis',
  'gross',
  'Oscars_win_count',
  'release_date',
  'Oscar_nominated_categories',
  'genre',
  'release_date.year',
  'release_date.day-of-month',
  'release_date.day-of-week')

oscars <- oscars %>% 
  select(-one_of(drop.cols)) %>%
  select(-matches("categories$")) %>% 
  select(-matches("Oscar_.*_won$"))

# Going to drop release_date.month for now
oscars$release_date.month <- NULL
```

And for when the rest of the preprocessing is done, this is for splitting. I would say let's use from 2000 to 2012 (75%) for training and from 2013 to 2016 for testing. No need to stratify as we are not doing a random split. 
```{r}
# Splits by years
oscars_train <- subset(oscars, year %in% c(2000:2012)) 
oscars_test <- subset(oscars, year %in% c(2013:2016))

# Drops year
oscars$year <- NULL
oscars_train$year <- NULL
oscars_test$year <- NULL

# Gets the target
y_train = oscars_train$Oscars_won_some
y_test = oscars_test$Oscars_won_some
# Drops the target column
X_train <- oscars_train
X_train$Oscars_won_some <- NULL
X_test <- oscars_test
X_test$Oscars_won_some <- NULL

# Checking if our new objects make sense
head(y_train)
sapply(X_train, typeof)
```

Standardizing ([source](https://machinelearningmastery.com/pre-process-your-dataset-in-r/)).
```{r}
scaleParam <- preProcess(oscars_train, method=c("center", "scale"))
oscars_train <- predict(scaleParam, oscars_train)
oscars_test <- predict(scaleParam, oscars_test)

scaleParam <- preProcess(X_train, method=c("center", "scale"))
X_train <- predict(scaleParam, X_train)
X_test <- predict(scaleParam, X_test)

# No need to scale the target
```

### Code for some models

Logistic Regression

```{r}
# Trains the model
oscars_train_logit <-  glm(Oscars_won_some~.,
                 family = binomial(link = "logit"), data = oscars_train)
summary(oscars_train_logit)

# Prints out this error: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]) : # contrasts can be applied only to factors with 2 or more levels

# It turns out it is because oscars_train only has one level for genre_Documentary
unique(oscars_train$genre_Documentary)
# Let's see how many documentaries we have in total
table(oscars$genre_Documentary)
# So only one huh?. Let's see which movie it is
subset(oscars, genre_Documentary == "Yes")
# Oh damn it, we already dropped the column with the title
# Well, either way, it didn't won any Oscars and was only nominated for one
# which was almost surely Best Documentary, which we don't have, so let's drop the column
oscars$genre_Documentary <- NULL
oscars_train$genre_Documentary <- NULL
oscars_test$genre_Documentary <- NULL
X_train$genre_Documentary <- NULL
X_test$genre_Documentary <- NULL
# NOTE: we'll move this up later, I just left it here so you could see the reasoning

# Trains the model
oscars_train_logit <-  glm(Oscars_won_some~.,
                 family = binomial(link = "logit"), data = oscars_train)
#Prints out warnings
#Warning messages:
#1: glm.fit: algorithm did not converge 
#2: glm.fit: fitted probabilities numerically 0 or 1 occurred 
summary(oscars_train_logit)
# lol, this is maybe because of the missingness that hasn't been dealt with yet
sapply(oscars, function(x) sum(is.na(x)))
# well, actually we don't have that many... because we dropped the categories features
# for this try. popularity does have a significant number, but even so, not so sure this
# is the problem... 


# Tests the model
prob_test_pred <- predict.glm(oscars_train_logit,oscars_test,type='response')
score <- sum(ifelse(prob_test_pred > 0.5,1,0)==y_test)/length(y_test)
score

# ROC Curve
prob=plogis(predict.glm(oscars_train_logit, type = c("response")))
head(prob)
h <- roc(Oscars_won_some~prob, data=oscars_train)
plot(h)
# Area Under the Curve
auc(h)

# Prints the predicted probabilities of not winning any oscar (I think this is it because "NO" comes first for both y_train and y_test) for each movie
prob_test_pred
```

Ridge Logistic Regression

```{r}
X_train_m <- model.matrix(year~., X_train)
X_test_m <- model.matrix(year~., X_test)

# Trains the model
oscars_train_ridge_logit <- glmnet(X_train_m, y_train, alpha=0, nlambda=100,
                                 lambda.min.ratio=.0001, family = binomial(link = "logit"))

# Tests the model
ridge_probs_test_pred <- predict.glmnet(oscars_train_ridge_logit, X_test_m, type="response")
score <- sum(ifelse(ridge_probs_test_pred > 0.5,1,0)==y_test)/length(y_test)
score

# ROC Curve
prob_ridge=plogis(predict.glm(oscars_train_ridge_logit, type = c("response")))
head(prob_ridge)
h <- roc(Oscars_won_some~prob_ridge, data=oscars_train)
plot(h)
# Area Under the Curve
auc(h)

# Prints the predicted probabilities of not winning any oscar for each movie
ridge_probs_test_pred
```

Lasso Logistic Regression

```{r}
# Trains the model
oscars_train_lasso_logit <- glmnet(X_train_m, y_train, family=binomial(link = "logit"), alpha=1, nlambda=100,
                                 lambda.min.ratio=.0001)

# Tests the model
lasso_probs_test_pred <- predict.glmnet(oscars_train_lasso_logit, X_test_m, type="response")
score <- sum(ifelse(lasso_probs_test_pred > 0.5,1,0)==y_test)/length(y_test)
score

# ROC Curve
prob_lasso=plogis(predict.glm(oscars_train_lasso_logit, type = c("response")))
head(prob_lasso)
h <- roc(Oscars_won_some~prob_lasso, data=oscars_train)
plot(h)
# Area Under the Curve
auc(h)

# Prints the predicted probabilities of not winning any oscar for each movie
oscars_train_lasso_logit
```

Decision Tree


```{r}

```

Cross-Validation and Hyperparameter Tuning

TODO!
```{r}

```

# Category Cleanup. 


##### Pineapples
```{r}

# so I need to do this for categories and genre. 

#select(oscars, colnames(oscars)[grepl("categories",colnames(oscars))]) 

ag_cols = colnames(oscars)[grepl("categories",colnames(oscars))]

#determine # of na values for the LOndon_Critics_Circle wom column 
sum(is.na(oscars$London_Critics_Circle_Film_won_categories))

oscars[which(is.na(oscars$London_Critics_Circle_Film_won_categories)==TRUE),]$London_Critics_Circle_Film_won_categories = "none"



sum(length((which(oscars$London_Critics_Circle_Film_won_categories=="none"))))


length(unique(oscars$London_Critics_Circle_Film_won_categories))

london_unique = unique(oscars$London_Critics_Circle_Film_won_categories)

soup = c()
for(i in 1:length(london_unique)){
  soup = append(soup,unlist(strsplit(london_unique[i],"\\|")))
}
new_cols = unique(soup)
# do we change the "won" to a factor. 
# award wins doesn't count the oscars. 
```


#LCC wins 
```{r}
xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols


for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$London_Critics_Circle_Film_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

#re-name the columns so we can append them to the original dataframe
colnames(xw) = gsub(" ","_",colnames(xw))

colnames(xw) = paste("LCC_Won",colnames(xw),sep="_")
```
#LCC noms
```{r}
sum(is.na(oscars$London_Critics_Circle_Film_nominated_categories))

# get rid of all missing values 
oscars[which(is.na(oscars$London_Critics_Circle_Film_nominated_categories)==TRUE),]$London_Critics_Circle_Film_nominated_categories = "none"


london_nom_unique = unique(oscars$London_Critics_Circle_Film_nominated_categories)

soup = c()
for(i in 1:length(london_nom_unique)){
  soup = append(soup,unlist(strsplit(london_nom_unique[i],"\\|")))
}
new_cols = unique(soup)

# ok, WHAT? why do we have 28 nominated categories and ony 23 categories won 
# does that even make any sense... not to me :) 

x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols


for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$London_Critics_Circle_Film_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))

#re-name the columns so we can append them to the original dataframe
colnames(x) = paste("LCC_Nom",colnames(x),sep="_")


noms = gsub("LCC_Nom","",colnames(x))
wins = gsub("LCC_Won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) == TRUE){
  oscars = cbind(oscars,x,xw)
  }else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("LCC_Nom",noms[noms %in% wins],sep=""))],xw[,colnames(xw)%in%c(paste("LCC_Won",wins[wins %in% noms],sep=""))])
}  
```
# Golden Globe Wins
```{r}
sum(is.na(oscars$Golden_Globes_won_categories))

oscars[which(is.na(oscars$Golden_Globes_won_categories)==TRUE),]$Golden_Globes_won_categories = "none"


ggwon_unique = unique(oscars$Golden_Globes_won_categories)

soup = c()
for(i in 1:length(ggwon_unique)){
  soup = append(soup,unlist(strsplit(ggwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Golden_Globes_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("gg_won",colnames(xw),sep="_")


# we have clear errors.... , Comedy or Musical, Musical or comedy... where the rest of the text is 
# EXACTLY the same... 
gg_won_Best_Performance_by_an_Actor_in_a_Motion_Picture_Musical_Comedy = xw$`gg_won_Best_Performance_by_an_Actor_in_a_Motion_Picture_-_Comedy_or_Musical`+ xw$`gg_won_Best_Performance_by_an_Actor_in_a_Motion_Picture_-_Musical_or_Comedy`

gg_won_Best_Motion_Picture_Musical_Comedy = (xw$`gg_won_Best_Motion_Picture_-_Comedy_or_Musical` + xw$`gg_won_Best_Motion_Picture_-_Musical_or_Comedy`)

gg_won_Best_Performance_by_an_Actress_in_a_Motion_Picture_Musical_Comedy = 
xw$`gg_won_Best_Performance_by_an_Actress_in_a_Motion_Picture_-_Musical_or_Comedy`+xw$`gg_won_Best_Performance_by_an_Actress_in_a_Motion_Picture_-_Comedy_or_Musical`

max(gg_won_Best_Performance_by_an_Actor_in_a_Motion_Picture_Musical_Comedy)
max(gg_won_Best_Motion_Picture_Musical_Comedy)
max(gg_won_Best_Performance_by_an_Actress_in_a_Motion_Picture_Musical_Comedy)
# phew, none overlapped .... 


xw = cbind(xw,gg_won_Best_Performance_by_an_Actor_in_a_Motion_Picture_Musical_Comedy,gg_won_Best_Motion_Picture_Musical_Comedy,gg_won_Best_Performance_by_an_Actress_in_a_Motion_Picture_Musical_Comedy) 


DropCols = c("gg_won_Best_Performance_by_an_Actor_in_a_Motion_Picture_-_Comedy_or_Musical","gg_won_Best_Performance_by_an_Actor_in_a_Motion_Picture_-_Musical_or_Comedy","gg_won_Best_Motion_Picture_-_Comedy_or_Musical","gg_won_Best_Motion_Picture_-_Musical_or_Comedy","gg_won_Best_Performance_by_an_Actress_in_a_Motion_Picture_-_Musical_or_Comedy","gg_won_Best_Performance_by_an_Actress_in_a_Motion_Picture_-_Comedy_or_Musical") 
length(DropCols)
dim(xw)
xw = xw[,!colnames(xw)%in%DropCols]
colnames(xw)
```

#golden globe nominations 
```{r}
sum(is.na(oscars$Golden_Globes_nominated_categories))

oscars[which(is.na(oscars$Golden_Globes_nominated_categories)==TRUE),]$Golden_Globes_nominated_categories = "none"


ggnom_unique = unique(oscars$Golden_Globes_nominated_categories)

soup = c()
for(i in 1:length(ggnom_unique)){
  soup = append(soup,unlist(strsplit(ggnom_unique[i],"\\|")))
}
new_cols = unique(soup)

# have to fix the repetitive column names. 
# combind 18 and 2 for best performance by an actor in motion picture, 
# combine 3 and 17 best motion picture, comedy or musical, v. musical or comedy. 
# combine 21 and 13 actress performance comedy musical 


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Golden_Globes_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("gg_nom",colnames(x),sep="_")
#re-name the columns so we can append them to the original dataframe

gg_nom_Best_Performance_by_an_Actor_in_a_Motion_Picture_Musical_Comedy = x$`gg_nom_Best_Performance_by_an_Actor_in_a_Motion_Picture_-_Comedy_or_Musical`+ x$`gg_nom_Best_Performance_by_an_Actor_in_a_Motion_Picture_-_Musical_or_Comedy`

gg_nom_Best_Motion_Picture_Musical_Comedy = (x$`gg_nom_Best_Motion_Picture_-_Comedy_or_Musical` + x$`gg_nom_Best_Motion_Picture_-_Musical_or_Comedy`)

gg_nom_Best_Performance_by_an_Actress_in_a_Motion_Picture_Musical_Comedy = 
x$`gg_nom_Best_Performance_by_an_Actress_in_a_Motion_Picture_-_Musical_or_Comedy`+x$`gg_nom_Best_Performance_by_an_Actress_in_a_Motion_Picture_-_Comedy_or_Musical`

max(gg_nom_Best_Performance_by_an_Actor_in_a_Motion_Picture_Musical_Comedy)
max(gg_nom_Best_Motion_Picture_Musical_Comedy)
max(gg_nom_Best_Performance_by_an_Actress_in_a_Motion_Picture_Musical_Comedy)


x = cbind(x,gg_nom_Best_Performance_by_an_Actor_in_a_Motion_Picture_Musical_Comedy,gg_nom_Best_Motion_Picture_Musical_Comedy,gg_nom_Best_Performance_by_an_Actress_in_a_Motion_Picture_Musical_Comedy) 

DropCols = c("gg_nom_Best_Performance_by_an_Actor_in_a_Motion_Picture_-_Comedy_or_Musical","gg_nom_Best_Performance_by_an_Actor_in_a_Motion_Picture_-_Musical_or_Comedy","gg_nom_Best_Motion_Picture_-_Comedy_or_Musical","gg_nom_Best_Motion_Picture_-_Musical_or_Comedy","gg_nom_Best_Performance_by_an_Actress_in_a_Motion_Picture_-_Musical_or_Comedy","gg_nom_Best_Performance_by_an_Actress_in_a_Motion_Picture_-_Comedy_or_Musical") 

x = x[,!colnames(x)%in%DropCols]

dim(x)
#######

noms = gsub("gg_nom","",colnames(x))
wins = gsub("gg_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("gg_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("gg_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)

```

#BAFTA won

```{r}

sum(is.na(oscars$BAFTA_won_categories))

oscars[which(is.na(oscars$BAFTA_won_categories)==TRUE),]$BAFTA_won_categories = "none"


bafwon_unique = unique(oscars$BAFTA_won_categories)
#wonderful, so there's one that's blank, it needs to be dropped. 

soup = c()
for(i in 1:length(bafwon_unique)){
  soup = append(soup,unlist(strsplit(bafwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$BAFTA_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("baf_won",colnames(xw),sep="_")

# 3 clear instances of the same award with separate punctuation. 
baf_won_hair = xw$`baf_won_Best_Make_Up_&_Hair` + xw$baf_won_Best_Makeup_and_Hair + xw$`baf_won_Best_Make_Up/Hair`

baf_won_ad_screen = xw$baf_won_Best_Adapted_Screenplay + xw$`baf_won_Best_Screenplay_(Adapted)` + xw$`baf_won_Best_Screenplay_-_Adapted`

baf_won_or_screen = xw$baf_won_Best_Original_Screenplay + xw$`baf_won_Best_Screenplay_(Original)` + xw$`baf_won_Best_Screenplay_-_Original`

# checking if the same film somehow got more than one award that we combined...
# if so, problematic
max(baf_won_or_screen)
max(baf_won_ad_screen)
max(baf_won_hair)



DropCols = c("baf_won_",'baf_won_Best_Make_Up_&_Hair', 'baf_won_Best_Makeup_and_Hair', 'baf_won_Best_Make_Up/Hair',"baf_won_Best_Adapted_Screenplay","baf_won_Best_Screenplay_(Adapted)","baf_won_Best_Screenplay_-_Adapted","baf_won_Best_Original_Screenplay", "baf_won_Best_Screenplay_(Original)","baf_won_Best_Screenplay_-_Original") 
length(DropCols)
dim(xw)
xw = xw[,!colnames(xw)%in%DropCols]

dim(xw)
xw = cbind(xw,baf_won_or_screen, baf_won_ad_screen, baf_won_hair)
```
#BAFTA Nom
```{r}
oscars[which(is.na(oscars$BAFTA_nominated_categories)==TRUE),]$BAFTA_nominated_categories = "none"


bafnom_unique = unique(oscars$BAFTA_nominated_categories)
#wonderful, so there's one that's blank, it needs to be dropped. 

soup = c()
for(i in 1:length(bafnom_unique)){
  soup = append(soup,unlist(strsplit(bafnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$BAFTA_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("baf_nom",colnames(x),sep="_")


baf_nom_hair = x$`baf_nom_Best_Make_Up_&_Hair` + x$baf_nom_Best_Makeup_and_Hair + x$`baf_nom_Best_Make_Up/Hair`

baf_nom_ad_screen = x$baf_nom_Best_Adapted_Screenplay + x$`baf_nom_Best_Screenplay_(Adapted)` + x$`baf_nom_Best_Screenplay_-_Adapted`

baf_nom_or_screen = x$baf_nom_Best_Original_Screenplay + x$`baf_nom_Best_Screenplay_(Original)` + x$`baf_nom_Best_Screenplay_-_Original`

max(baf_nom_or_screen)
max(baf_nom_ad_screen)
max(baf_nom_hair)



DropCols = c("baf_nom_",'baf_nom_Best_Make_Up_&_Hair', 'baf_nom_Best_Makeup_and_Hair', 'baf_nom_Best_Make_Up/Hair',"baf_nom_Best_Adapted_Screenplay","baf_nom_Best_Screenplay_(Adapted)","baf_nom_Best_Screenplay_-_Adapted","baf_nom_Best_Original_Screenplay", "baf_nom_Best_Screenplay_(Original)","baf_nom_Best_Screenplay_-_Original") 
dim(x)
length(DropCols)
x = x[,!colnames(x)%in%DropCols]

x = cbind(x,baf_nom_hair,baf_nom_ad_screen,baf_nom_or_screen)
dim(x)

#######

noms = gsub("baf_nom","",colnames(x))
wins = gsub("baf_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("baf_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("baf_won",wins[wins %in% noms],sep=""))])
} 
```
# Screen actors guild won 
```{r}

sum(is.na(oscars$Screen_Actors_Guild_won_categories))

oscars[which(is.na(oscars$Screen_Actors_Guild_won_categories)==TRUE),]$Screen_Actors_Guild_won_categories = "none"


sagwon_unique = unique(oscars$Screen_Actors_Guild_won_categories)
#wonderful, so there's one that's blank, it needs to be dropped. 

soup = c()
for(i in 1:length(sagwon_unique)){
  soup = append(soup,unlist(strsplit(sagwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Screen_Actors_Guild_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("sag_won",colnames(xw),sep="_")

```
# Screen actors guild nominated
```{r}
sum(is.na(oscars$Screen_Actors_Guild_nominated_categories))

oscars[which(is.na(oscars$Screen_Actors_Guild_nominated_categories)==TRUE),]$Screen_Actors_Guild_nominated_categories = "none"


sagnom_unique = unique(oscars$Screen_Actors_Guild_nominated_categories)
#wonderful, so there's one that's blank, it needs to be dropped. 

soup = c()
for(i in 1:length(sagnom_unique)){
  soup = append(soup,unlist(strsplit(sagnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Screen_Actors_Guild_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("sag_nom",colnames(x),sep="_")



noms = gsub("sag_nom","",colnames(x))
wins = gsub("sag_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("sag_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("sag_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)
```

# Critics Choice Won 
```{r}
# so it appears that there was only 1 "best young actor/ress award given away in 2017"
# yet there are 4 categories, best male/female, best m/f under 21 best male and best female...  and apparently there are times when it reocrded best young.
#this is really confusing, 
# I might just combine all of it together or drop the feature. 
# I'm definitely advocating that we just keep a variable that says if it was nominiated for 
# one of these awards.
sum(is.na(oscars$Critics_Choice_won_categories))

oscars[which(is.na(oscars$Critics_Choice_won_categories)==TRUE),]$Critics_Choice_won_categories = "none"


ccwon_unique = unique(oscars$Critics_Choice_won_categories)
#wonderful, so there's one that's blank, it needs to be dropped. 

soup = c()
for(i in 1:length(ccwon_unique)){
  soup = append(soup,unlist(strsplit(ccwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Critics_Choice_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("cc_won",colnames(xw),sep="_")

# two different ways to spell the family film live action award. 
cc_won_fam_action = xw$`cc_won_Best_Family_Film_(Live_Action)` + xw$`cc_won_Best_Family_Film_-_Live_Action` 


max(cc_won_fam_action)


DropCols = c("cc_won_Best_Family_Film_(Live_Action)","cc_won_Best_Family_Film_-_Live_Action","cc_won_") 

length(DropCols)
dim(xw)
xw = xw[,!colnames(xw)%in%DropCols]

dim(xw)
xw = cbind(xw,cc_won_fam_action)
```
# Crictics Choice nominated
```{r}
sum(is.na(oscars$Critics_Choice_nominated_categories))

oscars[which(is.na(oscars$Critics_Choice_nominated_categories)==TRUE),]$Critics_Choice_nominated_categories = "none"


ccnom_unique = unique(oscars$Critics_Choice_nominated_categories)
#wonderful, so there's one that's blank, it needs to be dropped. 

soup = c()
for(i in 1:length(ccnom_unique)){
  soup = append(soup,unlist(strsplit(ccnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Critics_Choice_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("cc_nom",colnames(x),sep="_")

cc_nom_fam_action = x$`cc_nom_Best_Family_Film_(Live_Action)` + x$`cc_nom_Best_Family_Film_-_Live_Action` 

max(cc_nom_fam_action)


DropCols = c("cc_nom_Best_Family_Film_(Live_Action)","cc_nom_Best_Family_Film_-_Live_Action","cc_nom_") 

length(DropCols)
dim(x)
x = x[,!colnames(x)%in%DropCols]

dim(x)
x = cbind(x,cc_nom_fam_action)

###

noms = gsub("cc_nom","",colnames(x))
wins = gsub("cc_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("cc_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("cc_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)
```
##Directors Guild Won
```{r}
sum(is.na(oscars$Directors_Guild_won_categories))

oscars[which(is.na(oscars$Directors_Guild_won_categories)==TRUE),]$Directors_Guild_won_categories = "none"


dgwon_unique = unique(oscars$Directors_Guild_won_categories)
#wonderful, so there's one that's blank, it needs to be dropped. 

soup = c()
for(i in 1:length(dgwon_unique)){
  soup = append(soup,unlist(strsplit(dgwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Directors_Guild_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("dg_won",colnames(xw),sep="_")

```
# Directors guild nominated 
```{r}
sum(is.na(oscars$Directors_Guild_nominated_categories))

oscars[which(is.na(oscars$Directors_Guild_nominated_categories)==TRUE),]$Directors_Guild_nominated_categories = "none"


dgnom_unique = unique(oscars$Directors_Guild_nominated_categories)
#wonderful, so there's one that's blank, it needs to be dropped. 

soup = c()
for(i in 1:length(dgnom_unique)){
  soup = append(soup,unlist(strsplit(dgnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Directors_Guild_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("dg_nom",colnames(x),sep="_")

###

noms = gsub("dg_nom","",colnames(x))
wins = gsub("dg_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("dg_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("dg_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)
```
#Producer's Guild Won 
```{r}
sum(is.na(oscars$Producers_Guild_won_categories))

oscars[which(is.na(oscars$Producers_Guild_won_categories)==TRUE),]$Producers_Guild_won_categories = "none"


pgwon_unique = unique(oscars$Producers_Guild_won_categories)

soup = c()
for(i in 1:length(pgwon_unique)){
  soup = append(soup,unlist(strsplit(pgwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Producers_Guild_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("pg_won",colnames(xw),sep="_")
```
# Producer's Guild Nominated
```{r}
sum(is.na(oscars$Producers_Guild_nominated_categories))

oscars[which(is.na(oscars$Producers_Guild_nominated_categories)==TRUE),]$Producers_Guild_nominated_categories = "none"


pgnom_unique = unique(oscars$Producers_Guild_nominated_categories)
#wonderful, so there's one that's blank, it needs to be dropped. 

soup = c()
for(i in 1:length(pgnom_unique)){
  soup = append(soup,unlist(strsplit(pgnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Producers_Guild_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("pg_nom",colnames(x),sep="_")

DropCols = c("pg_nom_") 

length(DropCols)
dim(x)
x = x[,!colnames(x)%in%DropCols]
dim(x)

noms = gsub("pg_nom","",colnames(x))
wins = gsub("pg_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("pg_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("pg_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)


```
# Art Directors Guild won 
```{r}
sum(is.na(oscars$Art_Directors_Guild_won_categories))

oscars[which(is.na(oscars$Art_Directors_Guild_won_categories)==TRUE),]$Art_Directors_Guild_won_categories = "none"


adgwon_unique = unique(oscars$Art_Directors_Guild_won_categories)

soup = c()
for(i in 1:length(adgwon_unique)){
  soup = append(soup,unlist(strsplit(adgwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Art_Directors_Guild_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("adg_won",colnames(xw),sep="_")

DropCols = c("adg_won_")
dim(xw)
xw = xw[,!colnames(xw)%in%DropCols]
dim(xw)
```
# Art Directors Guild Nominated
```{r}
sum(is.na(oscars$Art_Directors_Guild_nominated_categories))

oscars[which(is.na(oscars$Art_Directors_Guild_nominated_categories)==TRUE),]$Art_Directors_Guild_nominated_categories = "none"


adgnom_unique = unique(oscars$Art_Directors_Guild_nominated_categories)

soup = c()
for(i in 1:length(adgnom_unique)){
  soup = append(soup,unlist(strsplit(adgnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Art_Directors_Guild_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("adg_nom",colnames(x),sep="_")


DropCols = c("adg_nom_")
dim(x)
x = x[,!colnames(x)%in%DropCols]
dim(x)

######

noms = gsub("adg_nom","",colnames(x))
wins = gsub("adg_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("adg_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("adg_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)
```
# Writers Guild Won categories
```{r}
sum(is.na(oscars$Writers_Guild_won_categories))

oscars[which(is.na(oscars$Writers_Guild_won_categories)==TRUE),]$Writers_Guild_won_categories = "none"


wgwon_unique = unique(oscars$Writers_Guild_won_categories)

soup = c()
for(i in 1:length(wgwon_unique)){
  soup = append(soup,unlist(strsplit(wgwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Writers_Guild_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("wg_won",colnames(xw),sep="_")


DropCols = c("wg_won_")
dim(xw)
length(DropCols)
xw = xw[,!colnames(xw)%in%DropCols]
dim(xw)
```
# Writers guild nominated
```{r}
sum(is.na(oscars$Writers_Guild_nominated_categories))

oscars[which(is.na(oscars$Writers_Guild_nominated_categories)==TRUE),]$Writers_Guild_nominated_categories = "none"


wgnom_unique = unique(oscars$Writers_Guild_nominated_categories)

soup = c()
for(i in 1:length(wgnom_unique)){
  soup = append(soup,unlist(strsplit(wgnom_unique[i],"\\|")))
}
new_cols = unique(soup)

x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Writers_Guild_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("wg_nom",colnames(x),sep="_")


DropCols = c("wg_nom_")
dim(x)
length(DropCols)
x = x[,!colnames(x)%in%DropCols]
dim(x)
####

noms = gsub("wg_nom","",colnames(x))
wins = gsub("wg_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("wg_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("wg_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)
```
# Costume designers guild won categories 
```{r}
sum(is.na(oscars$Costume_Designers_Guild_won_categories))

oscars[which(is.na(oscars$Costume_Designers_Guild_won_categories)==TRUE),]$Costume_Designers_Guild_won_categories = "none"


cdgwon_unique = unique(oscars$Costume_Designers_Guild_won_categories)

soup = c()
for(i in 1:length(cdgwon_unique)){
  soup = append(soup,unlist(strsplit(cdgwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Costume_Designers_Guild_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("cdg_won",colnames(xw),sep="_")

```
# costume designers guild nominated categories 
```{r}
sum(is.na(oscars$Costume_Designers_Guild_nominated_categories))

oscars[which(is.na(oscars$Costume_Designers_Guild_nominated_categories)==TRUE),]$Costume_Designers_Guild_nominated_categories = "none"


cdgnom_unique = unique(oscars$Costume_Designers_Guild_nominated_categories)

soup = c()
for(i in 1:length(cdgnom_unique)){
  soup = append(soup,unlist(strsplit(cdgnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_nom column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Costume_Designers_Guild_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("cdg_nom",colnames(x),sep="_")

noms = gsub("cdg_nom","",colnames(x))
wins = gsub("cdg_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("cdg_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("cdg_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)
```

# Online Film TV association won 
```{r}
oscars[which(is.na(oscars$Online_Film_Television_Association_won_categories)==TRUE),]$Online_Film_Television_Association_won_categories = "none"


oftvwon_unique = unique(oscars$Online_Film_Television_Association_won_categories)

soup = c()
for(i in 1:length(oftvwon_unique)){
  soup = append(soup,unlist(strsplit(oftvwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Online_Film_Television_Association_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("oftv_won",colnames(xw),sep="_")

# have to do it for male female breathrough because same award, different punctuation 

oftv_won_best_male_breakthrough = xw$`oftv_won_Best_Breakthrough_Performance:_Male` + xw$`oftv_won_Best_Breakthrough_Performance_-_Male`

oftv_won_best_female_breakthrough = xw$`oftv_won_Best_Breakthrough_Performance:_Female` + xw$`oftv_won_Best_Breakthrough_Performance_-_Female`

max(best_male_breakthrough)
max(best_female_breakthrough)


DropCols = c("oftv_won_Best_Breakthrough_Performance:_Male","oftv_won_Best_Breakthrough_Performance_-_Male","oftv_won_Best_Breakthrough_Performance:_Female","oftv_won_Best_Breakthrough_Performance_-_Female") 

length(DropCols)
dim(xw)
xw = xw[,!colnames(xw)%in%DropCols]
dim(xw)

xw = cbind(xw,oftv_won_best_male_breakthrough,oftv_won_best_female_breakthrough)


```

# Online Film TV assoc nominated 

```{r}
oscars[which(is.na(oscars$Online_Film_Television_Association_nominated_categories)==TRUE),]$Online_Film_Television_Association_nominated_categories = "none"


oftvnom_unique = unique(oscars$Online_Film_Television_Association_nominated_categories)

soup = c()
for(i in 1:length(oftvnom_unique)){
  soup = append(soup,unlist(strsplit(oftvnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Online_Film_Television_Association_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("oftv_nom",colnames(x),sep="_")

# have to do it for male female breathrough because same award, different punctuation 

oftv_nom_best_male_breakthrough = x$`oftv_nom_Best_Breakthrough_Performance:_Male` + x$`oftv_nom_Best_Breakthrough_Performance_-_Male`

oftv_nom_best_female_breakthrough = x$`oftv_nom_Best_Breakthrough_Performance:_Female` + x$`oftv_nom_Best_Breakthrough_Performance_-_Female`

max(oftv_nom_best_male_breakthrough)
max(oftv_nom_best_female_breakthrough)


DropCols = c("oftv_nom_Best_Breakthrough_Performance:_Male","oftv_nom_Best_Breakthrough_Performance_-_Male","oftv_nom_Best_Breakthrough_Performance:_Female","oftv_nom_Best_Breakthrough_Performance_-_Female") 

length(DropCols)
dim(x)
x = x[,!colnames(x)%in%DropCols]
dim(x)

x = cbind(x,oftv_nom_best_male_breakthrough,oftv_nom_best_female_breakthrough)

noms = gsub("oftv_nom","",colnames(x))
wins = gsub("oftv_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("oftv_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("oftv_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)
```
# Online Film Critics Society Won Categories
```{r}
oscars[which(is.na(oscars$Online_Film_Critics_Society_won_categories)==TRUE),]$Online_Film_Critics_Society_won_categories = "none"


ofcswon_unique = unique(oscars$Online_Film_Critics_Society_won_categories)

soup = c()
for(i in 1:length(ofcswon_unique)){
  soup = append(soup,unlist(strsplit(ofcswon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Online_Film_Critics_Society_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("ofcs_won",colnames(xw),sep="_")

# have to do it for original screenplay, adapted screenplay, only a comma differentiates them

ofcs_won_best_adpated_scrnply = xw$ofcs_won_Best_Adapted_Screenplay + xw$`ofcs_won_Best_Screenplay,_Adapted`

ofcs_won_best_orig_scrnply = xw$ofcs_won_Best_Original_Screenplay + xw$`ofcs_won_Best_Screenplay,_Original`

max(ofcs_won_best_adpated_scrnply)
max(ofcs_won_best_orig_scrnply)

DropCols = c("ofcs_won_Best_Adapted_Screenplay","ofcs_won_Best_Screenplay,_Adapted","ofcs_won_Best_Original_Screenplay","ofcs_won_Best_Screenplay,_Original") 

length(DropCols)
dim(xw)
xw = xw[,!colnames(xw)%in%DropCols]
dim(xw)

xw = cbind(xw,ofcs_won_best_orig_scrnply,ofcs_won_best_adpated_scrnply)
```
#Online Film Critics Society noms
```{r}
oscars[which(is.na(oscars$Online_Film_Critics_Society_nominated_categories)==TRUE),]$Online_Film_Critics_Society_nominated_categories = "none"


ofcsnom_unique = unique(oscars$Online_Film_Critics_Society_nominated_categories)

soup = c()
for(i in 1:length(ofcsnom_unique)){
  soup = append(soup,unlist(strsplit(ofcsnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_nom column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Online_Film_Critics_Society_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("ofcs_nom",colnames(x),sep="_")

# have to do it for original screenplay, adapted screenplay, only a comma differentiates them

ofcs_nom_best_adpated_scrnply = x$ofcs_nom_Best_Adapted_Screenplay + x$`ofcs_nom_Best_Screenplay,_Adapted`

ofcs_nom_best_orig_scrnply = x$ofcs_nom_Best_Original_Screenplay + x$`ofcs_nom_Best_Screenplay,_Original`

max(ofcs_nom_best_adpated_scrnply)
max(ofcs_nom_best_orig_scrnply)

DropCols = c("ofcs_nom_","ofcs_nom_Best_Adapted_Screenplay","ofcs_nom_Best_Screenplay,_Adapted","ofcs_nom_Best_Original_Screenplay","ofcs_nom_Best_Screenplay,_Original") 

length(DropCols)
dim(x)
x = x[,!colnames(x)%in%DropCols]
dim(x)

x = cbind(x,ofcs_best_orig_scrnply,ofcs_best_adpated_scrnply)


noms = gsub("ofcs_nom","",colnames(x))
wins = gsub("ofcs_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("ofcs_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("ofcs_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)
```
# People's Choice Won 

```{r}
oscars[which(is.na(oscars$People_Choice_won_categories)==TRUE),]$People_Choice_won_categories = "none"


pcwon_unique = unique(oscars$People_Choice_won_categories)

soup = c()
for(i in 1:length(pcwon_unique)){
  soup = append(soup,unlist(strsplit(pcwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$People_Choice_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("pc_won",colnames(xw),sep="_")

# inconsistent spelling/punct for movie drama v. drama movie, movie comedy comedy movie, on screen matchup.

pc_won_best_drama = xw$pc_won_Favorite_Drama_Movie + xw$pc_won_Favorite_Movie_Drama

pc_won_best_comedy = xw$pc_won_Favorite_Movie_Comedy+ xw$pc_won_Favorite_Comedy_Movie

pc_won_best_onscrn_matchup = xw$`pc_won_Favorite_On-Screen_Match-Up` + xw$`pc_won_Favorite_On_Screen_Match-up`

max(pc_won_best_drama)
max(pc_won_best_comedy)
max(pc_won_best_onscrn_matchup)

DropCols = c("pc_won_Favorite_Drama_Movie","pc_won_Favorite_Movie_Drama","pc_won_Favorite_Movie_Comedy","pc_won_Favorite_Comedy_Movie","pc_won_Favorite_On-Screen_Match-Up","pc_won_Favorite_On_Screen_Match-up") 

length(DropCols)
dim(xw)
xw = xw[,!colnames(xw)%in%DropCols]
dim(xw)

xw = cbind(xw,pc_won_best_drama,pc_won_best_comedy,pc_won_best_onscrn_matchup)
```
# PC nominated
```{r}
oscars[which(is.na(oscars$People_Choice_nominated_categories)==TRUE),]$People_Choice_nominated_categories = "none"


pcnom_unique = unique(oscars$People_Choice_nominated_categories)

soup = c()
for(i in 1:length(pcnom_unique)){
  soup = append(soup,unlist(strsplit(pcnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_nom column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$People_Choice_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("pc_nom",colnames(x),sep="_")

# inconsistent spelling/punct for movie drama v. drama movie, movie comedy comedy movie, on screen matchup.

pc_nom_best_drama = x$pc_nom_Favorite_Drama_Movie + x$pc_nom_Favorite_Movie_Drama

pc_nom_best_comedy = x$pc_nom_Favorite_Movie_Comedy+ x$pc_nom_Favorite_Comedy_Movie

pc_nom_best_onscrn_matchup = x$`pc_nom_Favorite_On-Screen_Match-Up` + x$`pc_nom_Favorite_On_Screen_Match-up`

max(pc_nom_best_drama)
max(pc_nom_best_comedy)
max(pc_nom_best_onscrn_matchup)

DropCols = c("pc_nom_Favorite_Drama_Movie","pc_nom_Favorite_Movie_Drama","pc_nom_Favorite_Movie_Comedy","pc_nom_Favorite_Comedy_Movie","pc_nom_Favorite_On-Screen_Match-Up","pc_nom_Favorite_On_Screen_Match-up") 

length(DropCols)
dim(x)
x = x[,!colnames(x)%in%DropCols]
dim(x)

x = cbind(x,pc_nom_best_drama,pc_nom_best_comedy,pc_nom_best_onscrn_matchup)

noms = gsub("pc_nom","",colnames(x))
wins = gsub("pc_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("pc_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("pc_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)
```
# American Cinema Editors won categories. 

```{r}
oscars[which(is.na(oscars$American_Cinema_Editors_won_categories)==TRUE),]$American_Cinema_Editors_won_categories = "none"


acewon_unique = unique(oscars$American_Cinema_Editors_won_categories)

soup = c()
for(i in 1:length(acewon_unique)){
  soup = append(soup,unlist(strsplit(acewon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$American_Cinema_Editors_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("ace_won",colnames(xw),sep="_")

# inconsistent spelling/punct for movie drama v. drama movie, movie comedy comedy movie, on screen matchup.

ace_won_best_comedy_or_musical = xw$`ace_won_Best_Edited_Feature_Film_(Comedy_or_Musical)` + xw$`ace_won_Best_Edited_Feature_Film_-_Comedy_or_Musical`

ace_won_best_dramatic = xw$`ace_won_Best_Edited_Feature_Film_(Dramatic)` + xw$`ace_won_Best_Edited_Feature_Film_-_Dramatic`


max(ace_won_best_dramatic)
max(ace_won_best_comedy_or_musical)

DropCols = c("ace_won_Best_Edited_Feature_Film_(Comedy_or_Musical)","ace_won_Best_Edited_Feature_Film_-_Comedy_or_Musical","ace_won_Best_Edited_Feature_Film_(Dramatic)","ace_won_Best_Edited_Feature_Film_-_Dramatic") 

length(DropCols)
dim(xw)
xw = xw[,!colnames(xw)%in%DropCols]
dim(xw)

xw = cbind(xw,ace_won_best_dramatic,ace_won_best_comedy_or_musical)
```
# american cinema ed noms
```{r}
oscars[which(is.na(oscars$American_Cinema_Editors_nominated_categories)==TRUE),]$American_Cinema_Editors_nominated_categories = "none"


acenom_unique = unique(oscars$American_Cinema_Editors_nominated_categories)

soup = c()
for(i in 1:length(acenom_unique)){
  soup = append(soup,unlist(strsplit(acenom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_nom column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$American_Cinema_Editors_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("ace_nom",colnames(x),sep="_")

# inconsistent spelling/punct for movie drama v. drama movie, movie comedy comedy movie, on screen matchup.

ace_nom_best_comedy_or_musical = x$`ace_nom_Best_Edited_Feature_Film_(Comedy_or_Musical)` + x$`ace_nom_Best_Edited_Feature_Film_-_Comedy_or_Musical`

ace_nom_best_dramatic = x$`ace_nom_Best_Edited_Feature_Film_(Dramatic)` + x$`ace_nom_Best_Edited_Feature_Film_-_Dramatic`


max(ace_nom_best_dramatic)
max(ace_nom_best_comedy_or_musical)

DropCols = c("ace_nom_Best_Edited_Feature_Film_(Comedy_or_Musical)","ace_nom_Best_Edited_Feature_Film_-_Comedy_or_Musical","ace_nom_Best_Edited_Feature_Film_(Dramatic)","ace_nom_Best_Edited_Feature_Film_-_Dramatic") 

length(DropCols)
dim(x)
x = x[,!colnames(x)%in%DropCols]
dim(x)

x = cbind(x,ace_nom_best_dramatic,ace_nom_best_comedy_or_musical)

noms = gsub("ace_nom","",colnames(x))
wins = gsub("ace_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("ace_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("ace_won",wins[wins %in% noms],sep=""))])
} 
dim(oscars)
```
# Hollywood Film Won 
```{r}
oscars[which(is.na(oscars$Hollywood_Film_won_categories)==TRUE),]$Hollywood_Film_won_categories = "none"


hfwon_unique = unique(oscars$Hollywood_Film_won_categories)

soup = c()
for(i in 1:length(hfwon_unique)){
  soup = append(soup,unlist(strsplit(hfwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Hollywood_Film_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("hf_won",colnames(xw),sep="_")

#somehow a "" was parsed, get rid of it 

DropCols = c("hf_won_") 

length(DropCols)
dim(xw)
xw = xw[,!colnames(xw)%in%DropCols]
dim(xw)

```
# Hollywood film nominated 
```{r}
oscars[which(is.na(oscars$Hollywood_Film_nominated_categories)==TRUE),]$Hollywood_Film_nominated_categories = "none"


hfnom_unique = unique(oscars$Hollywood_Film_nominated_categories)

soup = c()
for(i in 1:length(hfnom_unique)){
  soup = append(soup,unlist(strsplit(hfnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Hollywood_Film_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("hf_nom",colnames(x),sep="_")

#somehow a "" was parsed, get rid of it 

DropCols = c("hf_nom_") 

length(DropCols)
dim(x)
x = x[,!colnames(x)%in%DropCols]
dim(x)

noms = gsub("hf_nom","",colnames(x))
wins = gsub("hf_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("hf_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("hf_won",wins[wins %in% noms],sep=""))])
} 
```
# Austin Film Critics Association Won
```{r}
oscars[which(is.na(oscars$Austin_Film_Critics_Association_won_categories)==TRUE),]$Austin_Film_Critics_Association_won_categories = "none"


afcawon_unique = unique(oscars$Austin_Film_Critics_Association_won_categories)

soup = c()
for(i in 1:length(afcawon_unique)){
  soup = append(soup,unlist(strsplit(afcawon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Austin_Film_Critics_Association_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("afca_won",colnames(xw),sep="_")

# a "" was parsed somehow 

DropCols = c("afca_won_") 

length(DropCols)
dim(xw)
xw = xw[,!colnames(xw)%in%DropCols]
dim(xw)

```

```{r}
oscars[which(is.na(oscars$Austin_Film_Critics_Association_nominated_categories)==TRUE),]$Austin_Film_Critics_Association_nominated_categories = "none"


afcanom_unique = unique(oscars$Austin_Film_Critics_Association_nominated_categories)

soup = c()
for(i in 1:length(afcanom_unique)){
  soup = append(soup,unlist(strsplit(afcanom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Austin_Film_Critics_Association_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("afca_nom",colnames(x),sep="_")

# a "" was parsed somehow 

DropCols = c("afca_nom_") 

length(DropCols)
dim(x)
x = x[,!colnames(x)%in%DropCols]
dim(x)


noms = gsub("afca_nom","",colnames(x))
wins = gsub("afca_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("afca_nom",noms[noms %in% wins],sep=""))],xw[,colnames(xw)%in%c(paste("afca_won",wins[wins %in% noms],sep=""))])
} 
```
# Denver Film Critics Society 

```{r}
oscars[which(is.na(oscars$Denver_Film_Critics_Society_won_categories)==TRUE),]$Denver_Film_Critics_Society_won_categories = "none"


dfcswon_unique = unique(oscars$Denver_Film_Critics_Society_won_categories)

soup = c()
for(i in 1:length(dfcswon_unique)){
  soup = append(soup,unlist(strsplit(dfcswon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Denver_Film_Critics_Society_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("dfcs_won",colnames(xw),sep="_")

```
# Denver Film Critics Society Noms

```{r}
oscars[which(is.na(oscars$Denver_Film_Critics_Society_nominated_categories)==TRUE),]$Denver_Film_Critics_Society_nominated_categories = "none"


dfcsnom_unique = unique(oscars$Denver_Film_Critics_Society_nominated_categories)

soup = c()
for(i in 1:length(dfcsnom_unique)){
  soup = append(soup,unlist(strsplit(dfcsnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Denver_Film_Critics_Society_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("dfcs_nom",colnames(x),sep="_")

noms = gsub("dfcs_nom","",colnames(x))
wins = gsub("dfcs_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("dfcs_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("dfcs_won",wins[wins %in% noms],sep=""))])
} 
```
# Boston Society of Film Critics Won 
```{r}
oscars[which(is.na(oscars$Boston_Society_of_Film_Critics_won_categories)==TRUE),]$Boston_Society_of_Film_Critics_won_categories = "none"


bsofcwon_unique = unique(oscars$Boston_Society_of_Film_Critics_won_categories)

soup = c()
for(i in 1:length(bsofcwon_unique)){
  soup = append(soup,unlist(strsplit(bsofcwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Boston_Society_of_Film_Critics_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("bsofc_won",colnames(xw),sep="_")
```
# Boston Society nominated 

```{r}
oscars[which(is.na(oscars$Boston_Society_of_Film_Critics_nominated_categories)==TRUE),]$Boston_Society_of_Film_Critics_nominated_categories = "none"


bsofcnom_unique = unique(oscars$Boston_Society_of_Film_Critics_nominated_categories)

soup = c()
for(i in 1:length(bsofcnom_unique)){
  soup = append(soup,unlist(strsplit(bsofcnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_nom column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Boston_Society_of_Film_Critics_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("bsofc_nom",colnames(x),sep="_")

noms = gsub("bsofc_nom","",colnames(x))
wins = gsub("bsofc_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("bsofc_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("bsofc_won",wins[wins %in% noms],sep=""))])
} 
```
# New York Film Critics Circle Won 

```{r}
oscars[which(is.na(oscars$New_York_Film_Critics_Circle_won_categories)==TRUE),]$New_York_Film_Critics_Circle_won_categories = "none"


nyccwon_unique = unique(oscars$New_York_Film_Critics_Circle_won_categories)

soup = c()
for(i in 1:length(nyccwon_unique)){
  soup = append(soup,unlist(strsplit(nyccwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$New_York_Film_Critics_Circle_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("nycc_won",colnames(xw),sep="_")
```
# New York Critics Circle nominated categories

```{r}
oscars[which(is.na(oscars$New_York_Film_Critics_Circle_nominated_categories)==TRUE),]$New_York_Film_Critics_Circle_nominated_categories = "none"


nyccnom_unique = unique(oscars$New_York_Film_Critics_Circle_nominated_categories)

soup = c()
for(i in 1:length(nyccnom_unique)){
  soup = append(soup,unlist(strsplit(nyccnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_won column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$New_York_Film_Critics_Circle_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("nycc_nom",colnames(x),sep="_")


noms = gsub("nycc_nom","",colnames(x))
wins = gsub("nycc_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("nycc_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("nycc_won",wins[wins %in% noms],sep=""))])
} 

```
# Los Angeles Film Critics Association Won
```{r}
oscars[which(is.na(oscars$Los_Angeles_Film_Critics_Association_won_categories)==TRUE),]$Los_Angeles_Film_Critics_Association_won_categories = "none"


lafcwon_unique = unique(oscars$Los_Angeles_Film_Critics_Association_won_categories)

soup = c()
for(i in 1:length(lafcwon_unique)){
  soup = append(soup,unlist(strsplit(lafcwon_unique[i],"\\|")))
}
new_cols = unique(soup)


xw = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(xw) = new_cols

for(i in 1:ncol(xw)){
  # iterate over columns
  for(j in 1:nrow(xw)){
    # then rows
    # if the string with the column name is in the string for the awards_nom column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(xw[i]),oscars$Los_Angeles_Film_Critics_Association_won_categories[j])==TRUE)){ 
      xw[j,i] = 1
      }
    else{
      xw[j,i] = 0
    }
  }
}

colnames(xw) = gsub(" ","_",colnames(xw))
colnames(xw) = paste("lafc_won",colnames(xw),sep="_")
```


# Los Angeles Film Critics Association Nominated
```{r}
oscars[which(is.na(oscars$Los_Angeles_Film_Critics_Association_nominated_categories)==TRUE),]$Los_Angeles_Film_Critics_Association_nominated_categories = "none"


lafcnom_unique = unique(oscars$Los_Angeles_Film_Critics_Association_nominated_categories)

soup = c()
for(i in 1:length(lafcnom_unique)){
  soup = append(soup,unlist(strsplit(lafcnom_unique[i],"\\|")))
}
new_cols = unique(soup)


x = data.frame(matrix(nrow=nrow(oscars),ncol=length(new_cols)))
colnames(x) = new_cols

for(i in 1:ncol(x)){
  # iterate over columns
  for(j in 1:nrow(x)){
    # then rows
    # if the string with the column name is in the string for the awards_nom column in the original 
    # dataset.... give that variable a 1 in the new dataset 
    if((grepl(colnames(x[i]),oscars$Los_Angeles_Film_Critics_Association_nominated_categories[j])==TRUE)){ 
      x[j,i] = 1
      }
    else{
      x[j,i] = 0
    }
  }
}

colnames(x) = gsub(" ","_",colnames(x))
colnames(x) = paste("lafc_nom",colnames(x),sep="_")

# there was a "" that parsed, need to get rid of it. 

DropCols = c("lafc_nom_")

x = x[,!colnames(x)%in%DropCols]

noms = gsub("lafc_nom","",colnames(x))
wins = gsub("lafc_won","",colnames(xw))

length(wins[wins %in% noms])
length(noms[noms %in% wins])
# so, now, we will add the nominated and award columns for films that have been both nominated 
# for and won that award in the dataset
# if we don't care about this, we can alternatively just add all columns after they're created. 
if((length(wins[wins %in% noms]) == max(length(wins),length(noms))) ==TRUE){
  oscars = cbind(oscars,x,xw)
} else {oscars = cbind(oscars, x[,colnames(x)%in%c(paste("lafc_nom",noms[noms %in% wins],sep=""))], xw[,colnames(xw)%in%c(paste("lafc_won",wins[wins %in% noms],sep=""))])
} 


```

